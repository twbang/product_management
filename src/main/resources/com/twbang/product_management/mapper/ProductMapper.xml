<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.twbang.product_management.mapper.ProductMapper">
    <select id="getProductInfo" resultType="com.twbang.product_management.data.ProductVO">
        select * from product_info where pi_name like #{keyword}
        order by pi_seq desc limit 10 offset #{offset}
    </select>
    <select id="getProductCount" resultType="java.lang.Integer">
        select count(*) from product_info where pi_name like #{keyword}
    </select>
    <insert id="addProduct">
        insert into product_info(pi_name,pi_sub,pi_price,pi_sell,pi_as)
        values
        (#{pi_name},#{pi_sub},#{pi_price},#{pi_sell},#{pi_as})
    </insert>
    <delete id="deleteProduct">
        delete from product_info where pi_seq=#{seq}
    </delete>
    <select id="getProductInfoBySeq" resultType="com.twbang.product_management.data.ProductVO">
        select * from product_info where pi_seq=#{seq}
    </select>
    <update id="updateProduct">
        update product_info
        set pi_name=#{pi_name},pi_sub=#{pi_sub},pi_price=#{pi_price},pi_sell=#{pi_sell},pi_as=#{pi_as},pi_mod_dt=NOW()
        where pi_seq=#{pi_seq}
    </update>
    <select id="selectLatestDataSeq" resultType="java.lang.Integer">
        select pi_seq from product_info
        order by pi_seq desc limit 1
    </select>
    <insert id="insertProductHistory">
        INSERT INTO product_work_db.department_history
        (deph_type, deph_content, deph_pi_seq)
        VALUES(#{deph_type},#{deph_content},#{deph_pi_seq});
    </insert>
</mapper>